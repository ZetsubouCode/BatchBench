{% extends "base.html" %}
{% block content %}
  {% set tab = active_tab or 'webp' %}

  <ul class="nav nav-tabs mb-3" role="tablist">
    <li class="nav-item"><button class="nav-link {{ 'active' if tab=='webp' }}" data-bs-toggle="tab" data-bs-target="#tab-webp" type="button">WebP â†’ PNG Converter</button></li>
    <li class="nav-item"><button class="nav-link {{ 'active' if tab=='batch' }}" data-bs-toggle="tab" data-bs-target="#tab-batch" type="button">Photo Adjust (preset)</button></li>
    <li class="nav-item"><button class="nav-link {{ 'active' if tab=='tags' }}" data-bs-toggle="tab" data-bs-target="#tab-tags" type="button">Dataset Tag Editor</button></li>
    <li class="nav-item"><button class="nav-link {{ 'active' if tab=='offline_tagger' }}" data-bs-toggle="tab" data-bs-target="#tab-offline-tagger" type="button">Offline Tagger (WD v3)</button></li>
    <li class="nav-item"><button class="nav-link {{ 'active' if tab=='normalize' }}" data-bs-toggle="tab" data-bs-target="#tab-normalize" type="button">Dataset Normalization</button></li>
    <li class="nav-item"><button class="nav-link {{ 'active' if tab=='combine' }}" data-bs-toggle="tab" data-bs-target="#tab-combine" type="button">Combine Dataset</button></li>
    <li class="nav-item"><button class="nav-link {{ 'active' if tab=='rename' }}" data-bs-toggle="tab" data-bs-target="#tab-rename" type="button">Flatten & Renumber</button></li>
    <li class="nav-item"><button class="nav-link {{ 'active' if tab=='merge' }}" data-bs-toggle="tab" data-bs-target="#tab-merge" type="button">Stitch Groups</button></li>
    <li class="nav-item"><button class="nav-link {{ 'active' if tab=='webtoon' }}" data-bs-toggle="tab" data-bs-target="#tab-webtoon" type="button">Webtoon Panel Splitter</button></li>
    <li class="nav-item"><button class="nav-link {{ 'active' if tab=='pipeline' }}" data-bs-toggle="tab" data-bs-target="#tab-pipeline" type="button">Pipeline (beta)</button></li>
    <li class="nav-item ms-auto"><span class="nav-link disabled">Presets loaded: {{ preset_names|length }}</span></li>
  </ul>

  <div class="tab-content">
    <div class="tab-pane fade {{ 'show active' if tab=='webp' }}" id="tab-webp">
      {% include "webp_to_png.html" %}
    </div>

    <div class="tab-pane fade {{ 'show active' if tab=='batch' }}" id="tab-batch">
      {% include "batch_adjust.html" %}
    </div>

    <div class="tab-pane fade {{ 'show active' if tab=='tags' }}" id="tab-tags">
      {% include "dataset_labeling.html" %}
    </div>

    <div class="tab-pane fade {{ 'show active' if tab=='offline_tagger' }}" id="tab-offline-tagger">
      {% include "offline_tagger.html" %}
    </div>

    <div class="tab-pane fade {{ 'show active' if tab=='normalize' }}" id="tab-normalize">
      {% include "normalize_dataset.html" %}
    </div>

    <div class="tab-pane fade {{ 'show active' if tab=='combine' }}" id="tab-combine">
      {% include "combine_datasets.html" %}
    </div>
    
    <div class="tab-pane fade {{ 'show active' if tab=='rename' }}" id="tab-rename">
      {% include "group_renamer.html" %}
    </div>

    <div class="tab-pane fade {{ 'show active' if tab=='merge' }}" id="tab-merge">
      {% include "merge_groups.html" %}
    </div>

    <div class="tab-pane fade {{ 'show active' if tab=='webtoon' }}" id="tab-webtoon">
      {% include "webtoon_splitter.html" %}
    </div>

    <div class="tab-pane fade {{ 'show active' if tab=='pipeline' }}" id="tab-pipeline">
      {% include "pipeline.html" %}
    </div>
  </div>

  {% if log %}
    <div class="card p-3 mt-3">
      <h5>Log</h5>
      <pre class="monospace">{{ log }}</pre>
    </div>
  {% endif %}
{% endblock %}
